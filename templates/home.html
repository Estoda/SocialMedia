{% extends 'base.html' %} {% block content %} {% if user.is_authenticated %}

<div class="card post-card" style="max-width: 1000px; margin: 0 auto">
  <a href="{% url 'create-post' %}" class="btn btn-primary">Create Post</a>
</div>
<br />
{% for post in posts %}
<div
  id="post-{{ post.id }}"
  style="max-width: 1000px; margin: 0 auto"
  class="card post-card"
>
  <img
    src="{{ post.file.url }}"
    alt="Post Image"
    class="card-img-top post-image"
  />
  <div class="card-body">
    <h5 class="card-title">{{ post.user.username }}</h5>
    <p class="text-muted mb-1">Posted on {{ post.created_at }}</p>
    <p class="card-text">{{ post.content }}</p>
  </div>
  <div class="card-footer bg-white">
    <div class="d-flex justify-content-between align-items-center">
      <div
        style="display: flex; flex-wrap: wrap; gap: 5px"
        class="post-actions"
      >
        <form action="{% url 'like-post' post.id %}" method="post">
          {% csrf_token %} {% if request.user in post.likes.all %}
          <button class="btn btn-primary btn-sm">
            <i class="fa-solid fa-heart"></i> Like
          </button>
          {% else %}
          <button class="btn btn-outline-primary btn-sm">
            <i class="fa-solid fa-heart"></i> Like
          </button>
          {% endif %}
        </form>
        <form action="{% url 'dislike-post' post.id %}" method="post">
          {% csrf_token %} {% if request.user in post.dislikes.all %}
          <button class="btn btn-danger btn-sm">
            <i class="fa-solid fa-thumbs-down"></i> Dislike
          </button>
          {% else %}
          <button class="btn btn-outline-danger btn-sm">
            <i class="fa-solid fa-thumbs-down"></i> Dislike</button
          >{% endif %}
        </form>
        <button class="btn btn-secondary btn-sm">
          <i class="fa-solid fa-comment"></i> Comment
        </button>
      </div>
      <span class="text-muted small"
        >{{ post.total_likes }} Likes | {{post.total_dislikes }} Dislikes |
        {{post.total_comments }} Comments</span
      >
    </div>
  </div>
</div>
{% endfor %} {%else %}
<div class="col-md-6 offset-md-3">
  <h1>Login</h1>
  <br />
  <form action="{% url 'home' %}" method="POST">
    {% csrf_token %}
    <div class="mb-3">
      <input
        required
        type="text"
        class="form-control"
        name="username"
        placeholder="Username"
      />
    </div>
    <div class="mb-3">
      <input
        required
        type="password"
        class="form-control"
        name="password"
        placeholder="Password"
      />
    </div>
    <br />
    <button type="submit" class="btn btn-secondary">Login</button>
  </form>
</div>

<script>
  document.getElementById("postButton").addEventListener("click", function () {
    const postContent = document.getElementById("postContent").value.trim();

    if (!postContent) {
      alert("Please write something before posting.");
      return;
    }

    // Handle the post creation logic (e.g., send to server)
    alert("Post created successfully!");
    document.getElementById("postContent").value = ""; // Clear the text area
    document.getElementById("postImage").value = ""; // Clear the file input
  });
</script>
{% endif %} {% endblock %}
